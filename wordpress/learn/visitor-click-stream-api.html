<!-- nlhtyrnugl execute api -->
<script>
  function toggleDisabledState(disable) {
    const modalElements =  document.querySelectorAll('[id$="_open-modal"], [data-cta-id$="_open-modal"], [data-click-id$="_open-modal"]');

    modalElements.forEach(element => {
      if (disable) {
        if (element.getAttribute('class') === 'button-link-09') {
          element.style.setProperty('color', 'gray', 'important');
        } else {
          element.style.setProperty('background-color', 'gray', 'important');
        }
        element.style.setProperty('cursor', 'not-allowed', 'important');
        element.style.setProperty('pointer-events', 'none', 'important');

        const handler = function (event) {
          event.preventDefault();
          event.stopPropagation();
          return false;
        };

        element._disableClickHandler = handler;
        element.addEventListener('click', handler, true);
      } else {
        if (element.getAttribute('class') === 'button-link-09') {
          element.style.removeProperty('color');
        } else {
          element.style.removeProperty('background-color');
        }
        element.style.removeProperty('cursor');
        element.style.removeProperty('pointer-events');

        if (element._disableClickHandler) {
          element.removeEventListener('click', element._disableClickHandler, true);
          delete element._disableClickHandler;
        }
      }
    });
  }
</script>
<script>
  const timestampOfUserVisit = new Date();
  toggleDisabledState(true);
  // setTimeout(() => {
  document?.addEventListener("geoLoaded", function () {
    toggleDisabledState(false);
    let AB_test_bucket = "control"

    let fingerprint_id = "";
    try {
      if (typeof (AB_BUCKET) !== "undefined") {
        AB_test_bucket = AB_BUCKET
      }

      if (typeof (FINGERPRINT_ID) !== "undefined") {
        fingerprint_id = FINGERPRINT_ID;
      }
    } catch (error) { }

    let data1 = [
      {
        Lead_Created_Time: timestampOfUserVisit,
        Lead_Time_Zone: v_timezone,
        Event_Type_Name: eventName,
        Cancellation_reason: "",
        UTM_Campaign: webNearInfo.utm_campaign,
        UTM_Source: webNearInfo.utm_source,
        UTM_Medium: webNearInfo.utm_medium,
        UTM_Term: webNearInfo.utm_term,
        UTM_Content: webNearInfo.utm_content,
        Tracking_ID: "",
        User_ID: webNearInfo.user_id,
        Page_URL: webNearInfo.page_url,
        Country: webNearInfo.v_country,
        Client_Timezone: v_timezone,
        CTA_Page: webNearInfo.cta_page_url,
        Landing_Page: webNearInfo.l_page_url,
        Click_History: "",
        City: webNearInfo.wr__city,
        Device: webNearInfo.wr__device,
        User_Agent: encodeURIComponent(navigator?.userAgent || ""),
        Refferer: webNearInfo.wr__referrer,
        Region: webNearInfo.wr__region,
        AB_test_bucket: AB_test_bucket,
        fingerprint_id: fingerprint_id,
        step: "s1"
      },
    ];

    (async function (params) {
      let url = "https://nlhtyrnugl.execute-api.us-west-1.amazonaws.com/prod";
      let option = {
        method: "POST",
        headers: {
          "x-api-key": "fm0X61U99b80d5SlGjrxFaWjgxIBylhX3LkfYGPN",
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          dataset_id: "Marketing_data_new_logic",
          table_id: "Leads_Click_history",
          data: data1,
        }),
      };
      try {
        let sendRequst = await fetch(url, option);
      } catch (err) {
        console.error("data1 sendeding error", err);
      }

    })()
  });
  // }, "3000");

  setTimeout(() => {
    toggleDisabledState(false);
  }, "3000");
</script>